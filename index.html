<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Configurator Comparison</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 960px; margin: 2rem auto; }
    h1 { color: #EE3124; }
    .controls { margin-bottom: 1rem; }
    .controls label { font-weight: bold; margin-right: 0.5rem; }
    .controls select, .controls input[type="number"] { padding: 0.4rem; font-size: 0.95rem; margin-right: 1rem; }
    .slots { display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 1rem; }
    .slot { flex: 1 1 220px; border: 1px solid #ccc; border-radius: 6px; padding: 0.5rem; }
    .cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin: 2rem 0; }
    .card { border: 2px solid #EE3124; border-radius: 8px; padding: 1rem; position: relative; cursor: default; transition: transform 0.2s; }
    .card.selected { border-color: #0052CC; box-shadow: 0 0 8px rgba(0,82,204,0.5); transform: scale(1.02); }
    .card img { max-width: 100%; height: auto; }
    .card h2 { margin: 0.5rem 0; font-size: 1.1rem; }
    .card p { margin: 0.3rem 0; font-size: 0.9rem; }
    .card button { background: #EE3124; color: #fff; border: none; padding: 0.5rem; cursor: pointer; border-radius: 4px; margin: 0.5rem 0 0.25rem; width: 100%; }
    #pricingSection { border-top: 2px solid #EE3124; padding-top: 1rem; display: none; }
    #pricingTable { width: 100%; border-collapse: collapse; margin-top: 0.5rem; }
    #pricingTable th, #pricingTable td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    #promoPrice { width: 120px; }
    /* Modal */
    #featureModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    #featureModal .modal-content { background: #fff; padding: 1.5rem; border-radius: 8px; max-width: 500px; width: 90%; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
    #featureModal h3 { margin-top: 0; }
    #featureModal ul { padding-left: 1.2rem; }
    #featureModal button.close { background: #ccc; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Lexis+ Product Configurator Comparison</h1>

  <div class="controls">
    <label for="stateGroup">Client State Group</label>
    <select id="stateGroup"><option disabled selected>— Select Group —</option></select>
    <label for="numPlans">Number of Plans</label>
    <select id="numPlans" disabled><option disabled selected>— Select —</option><option>1</option><option>2</option><option>3</option><option>4</option></select>
  </div>

  <div class="slots controls" id="slotsContainer"></div>

  <div class="cards-grid" id="cards"></div>

  <div id="pricingSection">
    <h2>Pricing Table</h2>
    <div class="controls">
      <label for="promoPrice">Promotional Period Price</label>
      <input type="number" id="promoPrice" placeholder="0.00" disabled>
    </div>
    <table id="pricingTable">
      <thead><tr><th>Period</th><th>Total Price</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Feature Modal -->
  <div id="featureModal">
    <div class="modal-content">
      <h3>Plan Features</h3>
      <ul id="featureList"></ul>
      <button class="close">Close</button>
    </div>
  </div>

  <script>
    // Data definitions
    const stateGroups = {"Group A":[],"Group C":[],"Group D":[]};
    const tierMapping = {"Group A":["State Essential","State Enhanced","State Professional","Premiere"],"Group C":["State Essential","State Enhanced","State Professional","Premiere"],"Group D":["State Essential","State Enhanced","State Professional","Premiere"]};
    // Full feature lists per tier
    const featuresByTier = {
      // Based on PDF Master-A, Master-C, Master-D mapping
      "State Essential": {
        features: [
          "State Cases: broad state-specific case law",
          "State Statutes and Legislation: real-time jurisdiction updates",
          "State Briefs, Pleadings & Motions",
          "Verdicts and Settlements: largest collection",
          "State Jury Instructions",
          "Shepard’s Citations Service"
        ],
        logo: "LexisPlus.png"
      },
      "State Enhanced": {
        features: [
          "All State Essential features",
          "State Agency and Administrative Materials",
          "Federal Cases: widest federal case law",
          "Federal Legislative Materials: congressional acts & bills",
          "Automated Templates: State Automated Templates",
          "Matthew Bender: State edition",
          "Practical Guidance: All Forms & Practical Guidance"
        ],
        logo: "LexisPlus.png"
      },
      "State Professional": {
        features: [
          "All State Enhanced features",
          "Federal Agency & Administrative Materials",
          "CourtLink: court dockets & documents",
          "News: Law360 daily coverage",
          "Verdicts and Settlements",
          "Jury Instructions: All Jury Instructions"
        ],
        logo: "LexisPlus.png"
      },
      "Premiere": {
        features: [
          "All State Professional features",
          "AI Summaries: advanced AI insights",
          "Advanced Research Tools"
        ],
        logo: "LexisPlus.png"
      }
    };

    // DOM refs
    const sgSelect = document.getElementById('stateGroup');
    const numSelect = document.getElementById('numPlans');
    const slotsContainer = document.getElementById('slotsContainer');
    const cardsContainer = document.getElementById('cards');
    const promoInput = document.getElementById('promoPrice');
    const pricingSection = document.getElementById('pricingSection');
    const pricingBody = document.querySelector('#pricingTable tbody');
    const featureModal = document.getElementById('featureModal');
    const featureList = document.getElementById('featureList');
    const closeModalBtn = featureModal.querySelector('.close');

    let currentPlanIdx = null;

    // Initialize State Group dropdown
    Object.keys(stateGroups).forEach(g => sgSelect.add(new Option(g, g)));
    sgSelect.addEventListener('change', () => {
      numSelect.disabled = false;
      numSelect.selectedIndex = 0;
      cardsContainer.innerHTML = '';
      resetPricing();
    });

    // Render plan slots
    numSelect.addEventListener('change', () => {
      const n = +numSelect.value;
      slotsContainer.innerHTML = '';
      for (let i = 1; i <= n; i++) renderSlot(i);
      setupSlotLogic();
      cardsContainer.innerHTML = '';
      resetPricing();
    });

    function renderSlot(i) {
      const div = document.createElement('div');
      div.className = 'slot';
      div.id = 'slot' + i;
      div.innerHTML = `
        <label>Platform</label>
        <select id="platform${i}"><option disabled selected>— Select —</option><option>Lexis+</option><option>Lexis+ AI</option></select>
        <label>Category</label>
        <select id="tier${i}" disabled><option disabled selected>— Select —</option></select>
        <label>Price per month per attorney</label>
        <input type="number" id="price${i}" placeholder="0.00" disabled>
      `;
      slotsContainer.appendChild(div);
    }

    function setupSlotLogic() {
      currentPlanIdx = null;
      resetPricing();
      const slots = [...slotsContainer.children].map(div => ({
        plat: div.querySelector('select[id^=platform]'),
        tier: div.querySelector('select[id^=tier]'),
        price: div.querySelector('input[id^=price]'),
        idx: [...slotsContainer.children].indexOf(div)
      }));

      slots.forEach(s => {
        s.plat.disabled = false;
        s.plat.addEventListener('change', () => {
          s.tier.disabled = false;
          s.tier.innerHTML = '<option disabled selected>— Select —</option>';
          tierMapping[sgSelect.value].forEach(t => s.tier.add(new Option(t, t)));
          s.price.disabled = true;
          updateCards();
          resetPricing();
        });
        s.tier.addEventListener('change', () => { s.price.disabled = false; updateCards(); resetPricing(); });
        s.price.addEventListener('input', () => { updateCards(); resetPricing(); });
      });
    }

    function updateCards() {
      cardsContainer.innerHTML = '';
      currentPlanIdx = null;
      resetPricing();
      const slots = [...slotsContainer.children];
      slots.forEach((div, i) => {
        const plat = div.querySelector('select[id^=platform]').value;
        const tier = div.querySelector('select[id^=tier]').value;
        const price = div.querySelector('input[id^=price]').value;
        if (plat && tier) {
          const data = featuresByTier[tier];
          const card = document.createElement('div');
          card.className = 'card';
          card.dataset.slot = i;
          card.innerHTML = `
            <img src="${data.logo}" alt="Logo">
            <h2>${plat} - ${tier}</h2>
            <p><strong>Price:</strong> $${price} / attorney/mo</p>
            <p><strong>Features:</strong> ${data.features.join('; ')}</p>
            <button data-slot="${i}" class="pricing-btn">Show Pricing Table</button>
            <button data-slot="${i}" class="details-btn">View Full Features</button>
          `;
          cardsContainer.appendChild(card);
        }
      });

      document.querySelectorAll('.pricing-btn').forEach(btn => btn.addEventListener('click', () => {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
        const card = btn.closest('.card');
        card.classList.add('selected');
        currentPlanIdx = +btn.dataset.slot;
        promoInput.disabled = false;
        generateTable();
      }));

      document.querySelectorAll('.details-btn').forEach(btn => btn.addEventListener('click', () => {
        const idx = +btn.dataset.slot;
        const div = slotsContainer.children[idx];
        const tier = div.querySelector('select[id^=tier]').value;
        showModal(featuresByTier[tier].features);
      }));
    }

    function resetPricing() {
      pricingSection.style.display = 'none';
      promoInput.disabled = true;
      promoInput.value = '';
      pricingBody.innerHTML = '';
      document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
    }

    function generateTable() {
      if (currentPlanIdx === null) return;
      const div = slotsContainer.children[currentPlanIdx];
      const price = +div.querySelector('input[id^=price]').value;
      const promo = promoInput.value;
      const y1 = price * 12;
      const y2 = y1 * 1.03;
      const y3 = y2 * 1.03;
      pricingBody.innerHTML = `
        <tr><td>Promotional Period</td><td>$${parseFloat(promo || 0).toFixed(2)}</td></tr>
        <tr><td>Year 1</td><td>$${y1.toFixed(2)}</td></tr>
        <tr><td>Year 2</td><td>$${y2.toFixed(2)}</td></tr>
        <tr><td>Year 3</td><td>$${y3.toFixed(2)}</td></tr>
      `;
      pricingSection.style.display = 'block';
    }

    // Modal functionality
    function showModal(features) {
      featureList.innerHTML = '';
      features.forEach(f => {
        const li = document.createElement('li'); li.textContent = f;
        featureList.appendChild(li);
      });
      featureModal.style.display = 'flex';
    }
    closeModalBtn.addEventListener('click', () => featureModal.style.display = 'none');
    window.addEventListener('click', e => {
      if (e.target === featureModal) featureModal.style.display = 'none';
    });

    promoInput.addEventListener('input', generateTable);
  </script>
</body>
</html>

